{% extends "base.html" %}

{% block title %}{{ tournament.name }} - SCUTTA{% endblock %}

{% block container_style %}margin-top: 0;{% endblock %}

{% block header_left %}
<a href="{{ url_for('tournament') }}" class="text-xl font-bold truncate">
    {{ tournament.name }}
</a>
{% endblock %}

{% block content %}
<div class="bg-white p-6 rounded-lg shadow-sm overflow-x-auto">
    <div class="flex justify-between items-center mb-6">
        <h2 class="text-2xl font-bold">{{ tournament.name }} {{ _('대진표') }}</h2>
        {% if current_user.is_admin %}
        <div class="flex gap-2">
            <a href="{{ url_for('submit_tournament_results_page', tournament_id=tournament.id) }}"
                class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded transition text-sm">
                {{ _('결과 입력') }}
            </a>
            <button onclick="deleteTournament({{ tournament.id }})"
                class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded transition text-sm">
                {{ _('삭제') }}
            </button>
        </div>
        {% endif %}
    </div>

    <div class="flex justify-center min-w-[800px] p-4">
        <div class="tournament-container flex gap-8">
            {% for round_num, matches in rounds.items() %}
            <div class="flex flex-col justify-around gap-4 w-48 relative">
                <h3 class="text-center font-bold mb-4 bg-gray-100 py-1 rounded">
                    {% if round_num == rounds|length %}
                    {{ _('결승') }}
                    {% elif round_num == rounds|length - 1 %}
                    {{ _('4강') }}
                    {% else %}
                    {{ _('Round') }} {{ round_num }}
                    {% endif %}
                </h3>

                {% for match in matches %}
                <div class="border rounded-lg bg-white shadow-sm overflow-hidden text-sm relative z-10">
                    <div
                        class="flex justify-between p-2 {% if match.winner_id == match.p1_id %}bg-green-50 font-bold text-green-700{% endif %}">
                        <span class="truncate">{{ match.p1_name }}</span>
                        <span class="text-gray-500">{{ match.score_p1 }}</span>
                    </div>
                    <div
                        class="flex justify-between p-2 border-t {% if match.winner_id == match.p2_id %}bg-green-50 font-bold text-green-700{% endif %}">
                        <span class="truncate">{{ match.p2_name }}</span>
                        <span class="text-gray-500">{{ match.score_p2 }}</span>
                    </div>
                </div>
                {% endfor %}
            </div>

            <!-- Connector Lines Logic (Simplified for CSS) -->
            {% if not loop.last %}
            <div class="w-8"></div>
            {% endif %}

            {% endfor %}
        </div>
    </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script src="{{ url_for('static', filename='js/tournament_detail.js') }}"></script>
{% endblock %}